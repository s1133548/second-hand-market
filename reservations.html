<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>My Reservations â€” Second-Hand Market</title>

<style>
  :root{
    --accent:#2f8f4f;
    --text:#132a2d;
    --muted:#789094;
    --card-bg:#fff;
    --btn-gray:#e8eef0;
  }
  body{
    margin:0;
    padding:20px;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    background:#f4f7f8;
    display:flex;
    justify-content:center;
  }
  .page{
    width:100%;
    max-width:850px;
  }
  h1{
    margin:0 0 20px 0;
    color:var(--text);
  }

  /* reservation card */
  .card{
    display:flex;
    gap:14px;
    background:var(--card-bg);
    padding:12px;
    border-radius:12px;
    margin-bottom:14px;
    box-shadow:0 4px 14px rgba(10,20,20,0.05);
    align-items:flex-start;
  }
  .thumb{
    width:95px;
    height:95px;
    border-radius:10px;
    object-fit:cover;
    background:#e9eef0;
    flex-shrink:0;
  }

  .info{
    flex:1;
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .name{
    font-size:17px;
    font-weight:700;
    color:var(--text);
    margin:0;
  }
  .dates{
    color:var(--muted);
    font-size:14px;
    line-height:1.3;
  }
  .badge{
    display:inline-block;
    background:var(--accent);
    color:#fff;
    padding:3px 8px;
    border-radius:8px;
    font-size:12px;
    font-weight:600;
  }

  .remove-btn{
    padding:8px 12px;
    background:#e05454;
    color:#fff;
    border:none;
    border-radius:8px;
    font-weight:600;
    cursor:pointer;
    margin-top:5px;
    align-self:flex-start;
  }

  .empty{
    text-align:center;
    padding:40px 20px;
    color:var(--muted);
  }

  .nav-links{
    display:flex;
    justify-content:flex-start;
    gap:12px;
    margin-bottom:16px;
  }
  .nav-btn{
    padding:8px 12px;
    background:#fff;
    border:1px solid #d5e1e4;
    border-radius:10px;
    text-decoration:none;
    font-weight:600;
    color:var(--text);
  }

  @media (max-width:600px){
    .thumb{ width:80px; height:80px; }
    .name{ font-size:16px; }
  }
</style>
</head>
<body>

<div class="page">
  <div class="nav-links">
    <a class="nav-btn" href="index.html">Home</a>
    <a class="nav-btn" href="browse.html">Browse</a>
  </div>

  <h1>My Reservations</h1>
  <div id="list"></div>
</div>

<script>
  const LIST = document.getElementById("list");

  function loadReservations(){
    try{
      const raw = localStorage.getItem("shm_my_reservations");
      if(!raw){
        LIST.innerHTML = `<div class="empty">You have no reserved items yet.</div>`;
        return [];
      }
      const arr = JSON.parse(raw);
      if(arr.length === 0){
        LIST.innerHTML = `<div class="empty">You have no reserved items yet.</div>`;
        return [];
      }
      return arr;
    }catch(e){
      LIST.innerHTML = `<div class="empty">Error loading reservations.</div>`;
      return [];
    }
  }

  function removeReservation(id){
    const raw = localStorage.getItem("shm_my_reservations");
    if(!raw) return;
    let arr = JSON.parse(raw);
    arr = arr.filter(r => r.id !== id);
    localStorage.setItem("shm_my_reservations", JSON.stringify(arr));
    renderList();
  }

  function renderList(){
    const data = loadReservations();
    if(data.length === 0){
      LIST.innerHTML = `<div class="empty">You have no reserved items yet.</div>`;
      return;
    }

    LIST.innerHTML = "";
    data.forEach(r => {
      const card = document.createElement("div");
      card.className = "card";

      const img = document.createElement("img");
      img.className = "thumb";
      img.src = r.image_url || "";
      img.alt = "Item";

      const info = document.createElement("div");
      info.className = "info";

      const n = document.createElement("p");
      n.className = "name";
      n.textContent = r.name || "Unnamed item";

      const badge = document.createElement("span");
      badge.className = "badge";
      badge.textContent = "Reserved";

      const d = document.createElement("div");
      d.className = "dates";
      d.innerHTML =
        `Pickup Date: <strong>${r.pickup}</strong><br>
         Reserved On: <strong>${new Date(r.reserved_at).toLocaleString()}</strong>`;

      const btn = document.createElement("button");
      btn.className = "remove-btn";
      btn.textContent = "Remove Reservation";
      btn.onclick = () => removeReservation(r.id);

      info.appendChild(n);
      info.appendChild(badge);
      info.appendChild(d);
      info.appendChild(btn);

      card.appendChild(img);
      card.appendChild(info);

      LIST.appendChild(card);
