<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Login — Second-Hand Market</title>

<style>
  :root{
    --accent:#2f8f4f;
    --text:#163033;
    --bg:#f4f7f8;
    --card:#ffffff;
    --muted:#8ba0a4;
  }

  body{
    margin:0;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    background:var(--bg);
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
  }

  .card{
    width:95%;
    max-width:380px;
    background:var(--card);
    padding:28px;
    border-radius:14px;
    box-shadow:0 8px 18px rgba(0,0,0,0.06);
  }

  h2{
    margin:0 0 20px;
    text-align:center;
    color:var(--text);
    font-size:26px;
  }

  label{
    font-weight:600;
    display:block;
    margin-top:14px;
    color:var(--text);
  }

  input{
    width:100%;
    padding:12px;
    margin-top:6px;
    border:1px solid #d6e0e2;
    border-radius:10px;
    font-size:15px;
    outline:none;
  }

  button{
    width:100%;
    margin-top:22px;
    padding:12px;
    border:0;
    background:var(--accent);
    color:#fff;
    font-weight:700;
    border-radius:10px;
    cursor:pointer;
    font-size:16px;
  }

  .error{
    margin-top:12px;
    color:#d64545;
    text-align:center;
    font-weight:600;
    display:none;
  }

  .signup-link{
    margin-top:16px;
    text-align:center;
    font-size:15px;
  }
  .signup-link a{
    color:var(--accent);
    font-weight:600;
    text-decoration:none;
  }
</style>
</head>

<body>

<div class="card">
  <h2>Login</h2>

  <label>Email</label>
  <input id="email" type="email" placeholder="Enter your email">

  <label>Password</label>
  <input id="password" type="password" placeholder="Enter your password">

  <button id="loginBtn">Login</button>

  <div class="error" id="errorMsg">Invalid email or password</div>

  <div class="signup-link">
    Don’t have an account? <a href="signup.html">Create one</a>
  </div>
</div>

<script type="module">
  import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

  const supabase = createClient(
    "https://jdxdqmggyxhdycfmvygw.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpkeGRxbWdneXhoZHljZm12eWd3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM0OTAxNzYsImV4cCI6MjA3OTA2NjE3Nn0.HFwu8W_oAsY-enrdYbe-pqBYaWY6TECAruW-yINYNrE"
  );

  const loginBtn = document.getElementById("loginBtn");
  const errorMsg = document.getElementById("errorMsg");

  loginBtn.addEventListener("click", async ()=>{
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value.trim();

    if(!email || !password){
      errorMsg.textContent = "Please fill all fields";
      errorMsg.style.display = "block";
      return;
    }

    errorMsg.style.display = "none";

    const { data, error } = await supabase.auth.signInWithPassword({ email, password });

    if(error){
      errorMsg.textContent = "Incorrect email or password";
      errorMsg.style.display = "block";
      return;
    }

    // SUCCESS → redirect to homepage or browse page
    window.location.href = "index.html";
  });
</script>

</body>
</html>
